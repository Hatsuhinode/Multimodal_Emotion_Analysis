<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: MELD Feature Extraction Using GNN Pages: 1 -->
<svg width="966pt" height="1958pt"
 viewBox="0.00 0.00 966.00 1957.88" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 1953.88)">
<title>MELD Feature Extraction Using GNN</title>
<polygon fill="#2a2a2a" stroke="transparent" points="-4,4 -4,-1953.88 962,-1953.88 962,4 -4,4"/>
<text text-anchor="start" x="264.5" y="-1927.68" font-family="Arial" font-weight="bold" font-size="24.00" fill="#50e3c2">Enhanced Emotion GNN Architecture</text>
<g id="clust1" class="cluster">
<title>cluster_data_prep</title>
<polygon fill="#2a2a2a" stroke="white" stroke-width="0" points="407,-1651.6 407,-1907.88 769,-1907.88 769,-1651.6 407,-1651.6"/>
<text text-anchor="middle" x="588" y="-1894.28" font-family="Arial" font-size="12.00" fill="white">DATA PREPROCESSING &amp; SETUP</text>
</g>
<g id="clust2" class="cluster">
<title>cluster_graph_construction</title>
<polygon fill="#2a2a2a" stroke="white" stroke-width="0" points="8,-1337.17 8,-1623.6 451,-1623.6 451,-1337.17 8,-1337.17"/>
<text text-anchor="middle" x="229.5" y="-1610" font-family="Arial" font-size="12.00" fill="white">ADVANCED GRAPH CONSTRUCTION</text>
</g>
<g id="clust3" class="cluster">
<title>cluster_model_architecture</title>
<polygon fill="#2a2a2a" stroke="white" stroke-width="0" points="71,-790.47 71,-1309.17 636,-1309.17 636,-790.47 71,-790.47"/>
<text text-anchor="middle" x="353.5" y="-1295.57" font-family="Arial" font-size="12.00" fill="white">ENHANCED GNN MODEL ARCHITECTURE</text>
</g>
<g id="clust4" class="cluster">
<title>cluster_loss_optimization</title>
<polygon fill="#2a2a2a" stroke="white" stroke-width="0" points="426,-451.47 426,-762.47 645,-762.47 645,-451.47 426,-451.47"/>
<text text-anchor="middle" x="535.5" y="-748.87" font-family="Arial" font-size="12.00" fill="white">ENHANCED LOSS &amp; OPTIMIZATION</text>
</g>
<g id="clust5" class="cluster">
<title>cluster_training</title>
<polygon fill="#2a2a2a" stroke="white" stroke-width="0" points="653,-144.5 653,-547.47 892,-547.47 892,-144.5 653,-144.5"/>
<text text-anchor="middle" x="772.5" y="-533.87" font-family="Arial" font-size="12.00" fill="white">MULTI&#45;SEED TRAINING &amp; EVALUATION</text>
</g>
<g id="clust6" class="cluster">
<title>cluster_output</title>
<polygon fill="#2a2a2a" stroke="white" stroke-width="0" points="528,-8 528,-116.5 950,-116.5 950,-8 528,-8"/>
<text text-anchor="middle" x="739" y="-102.9" font-family="Arial" font-size="12.00" fill="white">OUTPUT &amp; VISUALIZATION</text>
</g>
<!-- seed_init -->
<g id="node1" class="node">
<title>seed_init</title>
<ellipse fill="#50e3c2" stroke="#50e3c2" cx="561" cy="-1857.66" rx="81.13" ry="21.43"/>
<text text-anchor="middle" x="561" y="-1860.66" font-family="Arial" font-size="10.00">Seed Initialization</text>
<text text-anchor="middle" x="561" y="-1849.66" font-family="Arial" font-size="10.00">(42, 2023, 7, 123, 314)</text>
</g>
<!-- data_load -->
<g id="node2" class="node">
<title>data_load</title>
<ellipse fill="#4a90e2" stroke="#4a90e2" cx="561" cy="-1769.24" rx="137.36" ry="21.43"/>
<text text-anchor="middle" x="561" y="-1772.24" font-family="Arial" font-size="10.00">Load BiLSTM Features</text>
<text text-anchor="middle" x="561" y="-1761.24" font-family="Arial" font-size="10.00">(Enhanced_Features_with_BiLSTM.json)</text>
</g>
<!-- seed_init&#45;&gt;data_load -->
<g id="edge1" class="edge">
<title>seed_init&#45;&gt;data_load</title>
<path fill="none" stroke="white" d="M561,-1836.18C561,-1825.63 561,-1812.56 561,-1800.84"/>
<polygon fill="white" stroke="white" points="564.5,-1800.57 561,-1790.57 557.5,-1800.57 564.5,-1800.57"/>
<text text-anchor="middle" x="608" y="-1811.25" font-family="Arial" font-size="9.00" fill="#ffd700">initialize reproducibility</text>
</g>
<!-- speaker_map -->
<g id="node3" class="node">
<title>speaker_map</title>
<ellipse fill="#4a90e2" stroke="#4a90e2" cx="480" cy="-1680.81" rx="65.11" ry="21.43"/>
<text text-anchor="middle" x="480" y="-1683.81" font-family="Arial" font-size="10.00">Speaker Mapping</text>
<text text-anchor="middle" x="480" y="-1672.81" font-family="Arial" font-size="10.00">(speaker_to_idx)</text>
</g>
<!-- data_load&#45;&gt;speaker_map -->
<g id="edge2" class="edge">
<title>data_load&#45;&gt;speaker_map</title>
<path fill="none" stroke="white" d="M542.21,-1748.19C531.3,-1736.55 517.4,-1721.71 505.51,-1709.03"/>
<polygon fill="white" stroke="white" points="507.8,-1706.35 498.41,-1701.45 502.69,-1711.14 507.8,-1706.35"/>
<text text-anchor="middle" x="556.5" y="-1722.82" font-family="Arial" font-size="9.00" fill="#98fb98">extract speakers</text>
</g>
<!-- class_weights -->
<g id="node4" class="node">
<title>class_weights</title>
<ellipse fill="#f5a623" stroke="#f5a623" cx="662" cy="-1680.81" rx="98.99" ry="21.43"/>
<text text-anchor="middle" x="662" y="-1683.81" font-family="Arial" font-size="10.00">Class Weight Computation</text>
<text text-anchor="middle" x="662" y="-1672.81" font-family="Arial" font-size="10.00">(Balanced + Minority Focus)</text>
</g>
<!-- data_load&#45;&gt;class_weights -->
<g id="edge3" class="edge">
<title>data_load&#45;&gt;class_weights</title>
<path fill="none" stroke="white" d="M584.43,-1748.19C598.42,-1736.22 616.35,-1720.87 631.45,-1707.95"/>
<polygon fill="white" stroke="white" points="633.73,-1710.61 639.05,-1701.45 629.18,-1705.29 633.73,-1710.61"/>
<text text-anchor="middle" x="655.5" y="-1722.82" font-family="Arial" font-size="9.00" fill="#98fb98">compute distribution</text>
</g>
<!-- dialogue_split -->
<g id="node5" class="node">
<title>dialogue_split</title>
<ellipse fill="#7ed321" stroke="#7ed321" cx="367" cy="-1573.38" rx="73.58" ry="21.43"/>
<text text-anchor="middle" x="367" y="-1576.38" font-family="Arial" font-size="10.00">Split by Dialogue ID</text>
<text text-anchor="middle" x="367" y="-1565.38" font-family="Arial" font-size="10.00">(train/dev/test)</text>
</g>
<!-- speaker_map&#45;&gt;dialogue_split -->
<g id="edge4" class="edge">
<title>speaker_map&#45;&gt;dialogue_split</title>
<path fill="none" stroke="white" d="M459.27,-1660.47C441.39,-1643.79 415.37,-1619.52 395.52,-1601"/>
<polygon fill="white" stroke="white" points="397.68,-1598.22 387.98,-1593.96 392.9,-1603.34 397.68,-1598.22"/>
<text text-anchor="middle" x="467.5" y="-1634.4" font-family="Arial" font-size="9.00" fill="#98fb98">apply mapping</text>
</g>
<!-- speaker_emb -->
<g id="node10" class="node">
<title>speaker_emb</title>
<ellipse fill="#7ed321" stroke="#7ed321" cx="554" cy="-1258.96" rx="73.58" ry="21.43"/>
<text text-anchor="middle" x="554" y="-1261.96" font-family="Arial" font-size="10.00">Speaker Embedding</text>
<text text-anchor="middle" x="554" y="-1250.96" font-family="Arial" font-size="10.00">(32 dimensions)</text>
</g>
<!-- speaker_map&#45;&gt;speaker_emb -->
<g id="edge9" class="edge">
<title>speaker_map&#45;&gt;speaker_emb</title>
<path fill="none" stroke="white" d="M493.06,-1659.75C496.35,-1654.06 499.61,-1647.73 502,-1641.6 513.1,-1613.07 517,-1604.99 517,-1574.38 517,-1574.38 517,-1574.38 517,-1370.17 517,-1341.51 528.38,-1310.74 538.52,-1289.01"/>
<polygon fill="white" stroke="white" points="541.68,-1290.52 542.9,-1280 535.38,-1287.47 541.68,-1290.52"/>
<text text-anchor="middle" x="556.5" y="-1472.47" font-family="Arial" font-size="9.00" fill="#dda0dd">create embeddings</text>
</g>
<!-- focal_loss -->
<g id="node18" class="node">
<title>focal_loss</title>
<polygon fill="#d0021b" stroke="#d0021b" points="611,-733.47 459,-733.47 459,-681.47 611,-681.47 611,-733.47"/>
<text text-anchor="middle" x="535" y="-721.47" font-family="Arial" font-size="10.00">Enhanced Adaptive Focal Loss</text>
<text text-anchor="middle" x="535" y="-710.47" font-family="Arial" font-size="10.00">• Gamma base: 3.0</text>
<text text-anchor="middle" x="535" y="-699.47" font-family="Arial" font-size="10.00">• Label smoothing: 0.15</text>
<text text-anchor="middle" x="535" y="-688.47" font-family="Arial" font-size="10.00">• Minority penalty: 4.0x</text>
</g>
<!-- class_weights&#45;&gt;focal_loss -->
<g id="edge19" class="edge">
<title>class_weights&#45;&gt;focal_loss</title>
<path fill="none" stroke="white" d="M662,-1659.21C662,-1637.95 662,-1603.85 662,-1574.38 662,-1574.38 662,-1574.38 662,-818.68 662,-783.47 633.82,-756.98 604,-738.8"/>
<polygon fill="white" stroke="white" points="605.56,-735.66 595.15,-733.66 602.04,-741.71 605.56,-735.66"/>
<text text-anchor="middle" x="699.5" y="-1169.04" font-family="Arial" font-size="9.00" fill="#ffd700">weight adjustment</text>
</g>
<!-- graph_builder -->
<g id="node6" class="node">
<title>graph_builder</title>
<polygon fill="#7ed321" stroke="#7ed321" points="435.5,-1506.17 292.5,-1506.17 292.5,-1443.17 435.5,-1443.17 435.5,-1506.17"/>
<text text-anchor="middle" x="364" y="-1494.17" font-family="Arial" font-size="10.00">build_dialogue_graph()</text>
<text text-anchor="middle" x="364" y="-1483.17" font-family="Arial" font-size="10.00">• Chronological (3&#45;step)</text>
<text text-anchor="middle" x="364" y="-1472.17" font-family="Arial" font-size="10.00">• Speaker&#45;based (long&#45;range)</text>
<text text-anchor="middle" x="364" y="-1461.17" font-family="Arial" font-size="10.00">• Emotion&#45;based</text>
<text text-anchor="middle" x="364" y="-1450.17" font-family="Arial" font-size="10.00">• Cross&#45;speaker reactions</text>
</g>
<!-- dialogue_split&#45;&gt;graph_builder -->
<g id="edge5" class="edge">
<title>dialogue_split&#45;&gt;graph_builder</title>
<path fill="none" stroke="white" d="M366.36,-1551.87C366.04,-1541.56 365.64,-1528.69 365.27,-1516.48"/>
<polygon fill="white" stroke="white" points="368.76,-1516.33 364.95,-1506.45 361.77,-1516.55 368.76,-1516.33"/>
<text text-anchor="middle" x="392" y="-1526.97" font-family="Arial" font-size="9.00" fill="#98fb98">build graphs</text>
</g>
<!-- edge_features -->
<g id="node7" class="node">
<title>edge_features</title>
<ellipse fill="#bd10e0" stroke="#bd10e0" cx="157" cy="-1371.17" rx="140.93" ry="21.43"/>
<text text-anchor="middle" x="157" y="-1374.17" font-family="Arial" font-size="10.00">Edge Features</text>
<text text-anchor="middle" x="157" y="-1363.17" font-family="Arial" font-size="10.00">[same_speaker, distance, emotion_same]</text>
</g>
<!-- graph_builder&#45;&gt;edge_features -->
<g id="edge6" class="edge">
<title>graph_builder&#45;&gt;edge_features</title>
<path fill="none" stroke="white" d="M301.61,-1443.08C270.89,-1428.02 234.4,-1410.12 205.76,-1396.08"/>
<polygon fill="white" stroke="white" points="207.27,-1392.92 196.75,-1391.66 204.19,-1399.21 207.27,-1392.92"/>
<text text-anchor="middle" x="293.5" y="-1417.97" font-family="Arial" font-size="9.00" fill="#87ceeb">generate edges</text>
</g>
<!-- oversampling -->
<g id="node8" class="node">
<title>oversampling</title>
<polygon fill="#bd10e0" stroke="#bd10e0" points="442.5,-1397.17 315.5,-1397.17 315.5,-1345.17 442.5,-1345.17 442.5,-1397.17"/>
<text text-anchor="middle" x="379" y="-1385.17" font-family="Arial" font-size="10.00">Minority Oversampling</text>
<text text-anchor="middle" x="379" y="-1374.17" font-family="Arial" font-size="10.00">• Fear, Sadness, Disgust</text>
<text text-anchor="middle" x="379" y="-1363.17" font-family="Arial" font-size="10.00">• Feature Perturbation</text>
<text text-anchor="middle" x="379" y="-1352.17" font-family="Arial" font-size="10.00">• 6x Enhancement</text>
</g>
<!-- graph_builder&#45;&gt;oversampling -->
<g id="edge7" class="edge">
<title>graph_builder&#45;&gt;oversampling</title>
<path fill="none" stroke="white" d="M368.54,-1442.94C370.19,-1431.77 372.07,-1419.07 373.77,-1407.53"/>
<polygon fill="white" stroke="white" points="377.28,-1407.75 375.28,-1397.34 370.36,-1406.72 377.28,-1407.75"/>
<text text-anchor="middle" x="412.5" y="-1417.97" font-family="Arial" font-size="9.00" fill="#ff69b4">enhance minorities</text>
</g>
<!-- edge_proj -->
<g id="node11" class="node">
<title>edge_proj</title>
<ellipse fill="#bd10e0" stroke="#bd10e0" cx="157" cy="-1258.96" rx="78.48" ry="21.43"/>
<text text-anchor="middle" x="157" y="-1261.96" font-family="Arial" font-size="10.00">Edge Projection</text>
<text text-anchor="middle" x="157" y="-1250.96" font-family="Arial" font-size="10.00">(3→16 dims + GELU)</text>
</g>
<!-- edge_features&#45;&gt;edge_proj -->
<g id="edge10" class="edge">
<title>edge_features&#45;&gt;edge_proj</title>
<path fill="none" stroke="white" d="M157,-1349.96C157,-1333.36 157,-1309.59 157,-1290.65"/>
<polygon fill="white" stroke="white" points="160.5,-1290.42 157,-1280.42 153.5,-1290.42 160.5,-1290.42"/>
<text text-anchor="middle" x="189" y="-1319.97" font-family="Arial" font-size="9.00" fill="#87ceeb">project features</text>
</g>
<!-- input_proj -->
<g id="node9" class="node">
<title>input_proj</title>
<ellipse fill="#7ed321" stroke="#7ed321" cx="358" cy="-1258.96" rx="104.8" ry="21.43"/>
<text text-anchor="middle" x="358" y="-1261.96" font-family="Arial" font-size="10.00">Input Projection</text>
<text text-anchor="middle" x="358" y="-1250.96" font-family="Arial" font-size="10.00">(Linear + GELU + LayerNorm)</text>
</g>
<!-- oversampling&#45;&gt;input_proj -->
<g id="edge8" class="edge">
<title>oversampling&#45;&gt;input_proj</title>
<path fill="none" stroke="white" d="M374.23,-1345.16C371.15,-1328.96 367.11,-1307.76 363.83,-1290.56"/>
<polygon fill="white" stroke="white" points="367.21,-1289.61 361.9,-1280.44 360.34,-1290.92 367.21,-1289.61"/>
<text text-anchor="middle" x="395.5" y="-1319.97" font-family="Arial" font-size="9.00" fill="#dda0dd">feed graphs</text>
</g>
<!-- gat1 -->
<g id="node12" class="node">
<title>gat1</title>
<polygon fill="#7ed321" stroke="#7ed321" points="416,-1191.74 300,-1191.74 300,-1150.74 416,-1150.74 416,-1191.74"/>
<text text-anchor="middle" x="358" y="-1179.74" font-family="Arial" font-size="10.00">GAT Layer 1</text>
<text text-anchor="middle" x="358" y="-1168.74" font-family="Arial" font-size="10.00">(4 heads, dropout=0.7)</text>
<text text-anchor="middle" x="358" y="-1157.74" font-family="Arial" font-size="10.00">+ Residual Connection</text>
</g>
<!-- input_proj&#45;&gt;gat1 -->
<g id="edge11" class="edge">
<title>input_proj&#45;&gt;gat1</title>
<path fill="none" stroke="white" d="M358,-1237.65C358,-1227.03 358,-1213.84 358,-1202.09"/>
<polygon fill="white" stroke="white" points="361.5,-1201.82 358,-1191.82 354.5,-1201.82 361.5,-1201.82"/>
<text text-anchor="middle" x="386.5" y="-1212.54" font-family="Arial" font-size="9.00" fill="#90ee90">node features</text>
</g>
<!-- speaker_emb&#45;&gt;gat1 -->
<g id="edge12" class="edge">
<title>speaker_emb&#45;&gt;gat1</title>
<path fill="none" stroke="white" d="M514.81,-1240.82C485.32,-1227.92 444.56,-1210.1 411.99,-1195.86"/>
<polygon fill="white" stroke="white" points="413.17,-1192.55 402.6,-1191.75 410.36,-1198.96 413.17,-1192.55"/>
<text text-anchor="middle" x="494.5" y="-1212.54" font-family="Arial" font-size="9.00" fill="#90ee90">speaker context</text>
</g>
<!-- edge_proj&#45;&gt;gat1 -->
<g id="edge13" class="edge">
<title>edge_proj&#45;&gt;gat1</title>
<path fill="none" stroke="white" d="M197.68,-1240.61C227.85,-1227.75 269.33,-1210.05 302.54,-1195.89"/>
<polygon fill="white" stroke="white" points="304.29,-1198.95 312.12,-1191.81 301.55,-1192.51 304.29,-1198.95"/>
<text text-anchor="middle" x="300.5" y="-1212.54" font-family="Arial" font-size="9.00" fill="#90ee90">edge attributes</text>
</g>
<!-- gat2 -->
<g id="node13" class="node">
<title>gat2</title>
<polygon fill="#7ed321" stroke="#7ed321" points="416,-1104.74 300,-1104.74 300,-1063.74 416,-1063.74 416,-1104.74"/>
<text text-anchor="middle" x="358" y="-1092.74" font-family="Arial" font-size="10.00">GAT Layer 2</text>
<text text-anchor="middle" x="358" y="-1081.74" font-family="Arial" font-size="10.00">(6 heads, dropout=0.7)</text>
<text text-anchor="middle" x="358" y="-1070.74" font-family="Arial" font-size="10.00">+ Residual Connection</text>
</g>
<!-- gat1&#45;&gt;gat2 -->
<g id="edge14" class="edge">
<title>gat1&#45;&gt;gat2</title>
<path fill="none" stroke="white" d="M358,-1150.53C358,-1140.02 358,-1126.86 358,-1115.12"/>
<polygon fill="white" stroke="white" points="361.5,-1114.85 358,-1104.85 354.5,-1114.85 361.5,-1114.85"/>
<text text-anchor="middle" x="393" y="-1125.54" font-family="Arial" font-size="9.00" fill="#90ee90">attention weights</text>
</g>
<!-- gat3 -->
<g id="node14" class="node">
<title>gat3</title>
<ellipse fill="#7ed321" stroke="#7ed321" cx="338" cy="-996.53" rx="86.03" ry="21.43"/>
<text text-anchor="middle" x="338" y="-999.53" font-family="Arial" font-size="10.00">GAT Layer 3</text>
<text text-anchor="middle" x="338" y="-988.53" font-family="Arial" font-size="10.00">(4 heads, concat=False)</text>
</g>
<!-- gat2&#45;&gt;gat3 -->
<g id="edge15" class="edge">
<title>gat2&#45;&gt;gat3</title>
<path fill="none" stroke="white" d="M353.36,-1063.36C350.9,-1052.81 347.82,-1039.61 345.06,-1027.81"/>
<polygon fill="white" stroke="white" points="348.43,-1026.84 342.75,-1017.9 341.62,-1028.43 348.43,-1026.84"/>
<text text-anchor="middle" x="391.5" y="-1038.54" font-family="Arial" font-size="9.00" fill="#90ee90">deep representation</text>
</g>
<!-- aux_classifier -->
<g id="node15" class="node">
<title>aux_classifier</title>
<ellipse fill="#bd10e0" stroke="#bd10e0" cx="535" cy="-996.53" rx="92.76" ry="21.43"/>
<text text-anchor="middle" x="535" y="-999.53" font-family="Arial" font-size="10.00">Auxiliary Classifier</text>
<text text-anchor="middle" x="535" y="-988.53" font-family="Arial" font-size="10.00">(Intermediate Supervision)</text>
</g>
<!-- gat2&#45;&gt;aux_classifier -->
<g id="edge16" class="edge">
<title>gat2&#45;&gt;aux_classifier</title>
<path fill="none" stroke="white" d="M399.46,-1063.7C411.58,-1057.95 424.83,-1051.62 437,-1045.74 453.84,-1037.61 472.25,-1028.58 488.53,-1020.56"/>
<polygon fill="white" stroke="white" points="490.41,-1023.53 497.83,-1015.97 487.31,-1017.26 490.41,-1023.53"/>
<text text-anchor="middle" x="506.5" y="-1038.54" font-family="Arial" font-size="9.00" fill="#dda0dd">intermediate supervision</text>
</g>
<!-- emotion_att -->
<g id="node16" class="node">
<title>emotion_att</title>
<ellipse fill="#bd10e0" stroke="#bd10e0" cx="390" cy="-908.11" rx="66.44" ry="21.43"/>
<text text-anchor="middle" x="390" y="-911.11" font-family="Arial" font-size="10.00">Emotion Attention</text>
<text text-anchor="middle" x="390" y="-900.11" font-family="Arial" font-size="10.00">(Context Pooling)</text>
</g>
<!-- gat3&#45;&gt;emotion_att -->
<g id="edge17" class="edge">
<title>gat3&#45;&gt;emotion_att</title>
<path fill="none" stroke="white" d="M350.06,-975.49C356.82,-964.25 365.37,-950.05 372.82,-937.67"/>
<polygon fill="white" stroke="white" points="375.85,-939.41 378,-929.04 369.85,-935.81 375.85,-939.41"/>
<text text-anchor="middle" x="397.5" y="-950.12" font-family="Arial" font-size="9.00" fill="#dda0dd">context pooling</text>
</g>
<!-- aux_classifier&#45;&gt;focal_loss -->
<g id="edge20" class="edge">
<title>aux_classifier&#45;&gt;focal_loss</title>
<path fill="none" stroke="white" d="M535,-974.89C535,-926.38 535,-804.66 535,-743.99"/>
<polygon fill="white" stroke="white" points="538.5,-743.75 535,-733.75 531.5,-743.75 538.5,-743.75"/>
<text text-anchor="middle" x="552" y="-861.69" font-family="Arial" font-size="9.00" fill="#ffd700">aux loss</text>
</g>
<!-- main_classifier -->
<g id="node17" class="node">
<title>main_classifier</title>
<ellipse fill="#9013fe" stroke="#9013fe" cx="420" cy="-819.68" rx="57.97" ry="21.43"/>
<text text-anchor="middle" x="420" y="-822.68" font-family="Arial" font-size="10.00">Main Classifier</text>
<text text-anchor="middle" x="420" y="-811.68" font-family="Arial" font-size="10.00">(Final Output)</text>
</g>
<!-- emotion_att&#45;&gt;main_classifier -->
<g id="edge18" class="edge">
<title>emotion_att&#45;&gt;main_classifier</title>
<path fill="none" stroke="white" d="M397.11,-886.62C400.85,-875.86 405.49,-862.47 409.63,-850.57"/>
<polygon fill="white" stroke="white" points="412.97,-851.61 412.94,-841.01 406.36,-849.31 412.97,-851.61"/>
<text text-anchor="middle" x="432.5" y="-861.69" font-family="Arial" font-size="9.00" fill="#dda0dd">final features</text>
</g>
<!-- main_classifier&#45;&gt;focal_loss -->
<g id="edge21" class="edge">
<title>main_classifier&#45;&gt;focal_loss</title>
<path fill="none" stroke="white" d="M439.77,-799.73C456.62,-783.58 481.22,-760 501.2,-740.86"/>
<polygon fill="white" stroke="white" points="503.81,-743.21 508.6,-733.76 498.96,-738.16 503.81,-743.21"/>
<text text-anchor="middle" x="488" y="-773.27" font-family="Arial" font-size="9.00" fill="#ffd700">main loss</text>
</g>
<!-- adamw_opt -->
<g id="node19" class="node">
<title>adamw_opt</title>
<polygon fill="#d0021b" stroke="#d0021b" points="593,-635.47 477,-635.47 477,-583.47 593,-583.47 593,-635.47"/>
<text text-anchor="middle" x="535" y="-623.47" font-family="Arial" font-size="10.00">AdamW Optimizer</text>
<text text-anchor="middle" x="535" y="-612.47" font-family="Arial" font-size="10.00">• LR: 5e&#45;5</text>
<text text-anchor="middle" x="535" y="-601.47" font-family="Arial" font-size="10.00">• Weight decay: 1e&#45;3</text>
<text text-anchor="middle" x="535" y="-590.47" font-family="Arial" font-size="10.00">• Gradient clipping: 0.5</text>
</g>
<!-- focal_loss&#45;&gt;adamw_opt -->
<g id="edge22" class="edge">
<title>focal_loss&#45;&gt;adamw_opt</title>
<path fill="none" stroke="white" d="M535,-681.24C535,-670.33 535,-657.37 535,-645.54"/>
<polygon fill="white" stroke="white" points="538.5,-645.52 535,-635.52 531.5,-645.52 538.5,-645.52"/>
<text text-anchor="middle" x="554.5" y="-656.27" font-family="Arial" font-size="9.00" fill="#ffd700">backprop</text>
</g>
<!-- scheduler -->
<g id="node20" class="node">
<title>scheduler</title>
<ellipse fill="#d0021b" stroke="#d0021b" cx="560" cy="-488.47" rx="77.15" ry="28.98"/>
<text text-anchor="middle" x="560" y="-496.97" font-family="Arial" font-size="10.00">ReduceLROnPlateau</text>
<text text-anchor="middle" x="560" y="-485.97" font-family="Arial" font-size="10.00">• Factor: 0.75</text>
<text text-anchor="middle" x="560" y="-474.97" font-family="Arial" font-size="10.00">• Patience: 4</text>
</g>
<!-- adamw_opt&#45;&gt;scheduler -->
<g id="edge23" class="edge">
<title>adamw_opt&#45;&gt;scheduler</title>
<path fill="none" stroke="white" d="M502.06,-583.43C495.1,-575.09 490.94,-565.39 495,-555.47 500.15,-542.9 508.98,-531.43 518.5,-521.72"/>
<polygon fill="white" stroke="white" points="521.08,-524.1 525.86,-514.64 516.23,-519.05 521.08,-524.1"/>
<text text-anchor="middle" x="525" y="-558.27" font-family="Arial" font-size="9.00" fill="#ffd700">LR scheduling</text>
</g>
<!-- scheduler&#45;&gt;adamw_opt -->
<g id="edge32" class="edge">
<title>scheduler&#45;&gt;adamw_opt</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M560.6,-517.65C560.3,-532.14 558.97,-549.97 555,-565.47 554.29,-568.23 553.41,-571.04 552.41,-573.82"/>
<polygon fill="#00ffff" stroke="#00ffff" points="549.16,-572.53 548.66,-583.12 555.65,-575.15 549.16,-572.53"/>
<text text-anchor="middle" x="578.5" y="-558.27" font-family="Arial" font-size="9.00" fill="#00ffff">LR update</text>
</g>
<!-- train_loop -->
<g id="node22" class="node">
<title>train_loop</title>
<polygon fill="#7ed321" stroke="#7ed321" points="826,-412.47 678,-412.47 678,-360.47 826,-360.47 826,-412.47"/>
<text text-anchor="middle" x="752" y="-400.47" font-family="Arial" font-size="10.00">Training Loop</text>
<text text-anchor="middle" x="752" y="-389.47" font-family="Arial" font-size="10.00">• Gradient accumulation</text>
<text text-anchor="middle" x="752" y="-378.47" font-family="Arial" font-size="10.00">• Early stopping (patience=10)</text>
<text text-anchor="middle" x="752" y="-367.47" font-family="Arial" font-size="10.00">• Warmup epochs: 3</text>
</g>
<!-- scheduler&#45;&gt;train_loop -->
<g id="edge25" class="edge">
<title>scheduler&#45;&gt;train_loop</title>
<path fill="none" stroke="white" d="M604.05,-464.52C630.92,-450.53 665.57,-432.48 694.58,-417.37"/>
<polygon fill="white" stroke="white" points="696.53,-420.3 703.78,-412.58 693.29,-414.1 696.53,-420.3"/>
<text text-anchor="middle" x="701.5" y="-433.27" font-family="Arial" font-size="9.00" fill="#87ceeb">optimize weights</text>
</g>
<!-- multi_seed -->
<g id="node21" class="node">
<title>multi_seed</title>
<polygon fill="#d0021b" stroke="#d0021b" points="787,-518.47 692,-488.47 787,-458.47 882,-488.47 787,-518.47"/>
<text text-anchor="middle" x="787" y="-491.47" font-family="Arial" font-size="10.00">Multi&#45;Seed Loop</text>
<text text-anchor="middle" x="787" y="-480.47" font-family="Arial" font-size="10.00">(5 different seeds)</text>
</g>
<!-- multi_seed&#45;&gt;train_loop -->
<g id="edge24" class="edge">
<title>multi_seed&#45;&gt;train_loop</title>
<path fill="none" stroke="white" d="M777.8,-461.19C773.61,-449.2 768.58,-434.84 764.09,-422"/>
<polygon fill="white" stroke="white" points="767.38,-420.81 760.77,-412.53 760.77,-423.13 767.38,-420.81"/>
<text text-anchor="middle" x="796.5" y="-433.27" font-family="Arial" font-size="9.00" fill="#87ceeb">iterate seeds</text>
</g>
<!-- stats_report -->
<g id="node26" class="node">
<title>stats_report</title>
<polygon fill="#9013fe" stroke="#9013fe" points="935.5,-72.25 810.5,-72.25 810.5,-31.25 941.5,-31.25 941.5,-66.25 935.5,-72.25"/>
<polyline fill="none" stroke="#9013fe" points="935.5,-72.25 935.5,-66.25 "/>
<polyline fill="none" stroke="#9013fe" points="941.5,-66.25 935.5,-66.25 "/>
<text text-anchor="middle" x="876" y="-60.25" font-family="Arial" font-size="10.00">Statistical Report</text>
<text text-anchor="middle" x="876" y="-49.25" font-family="Arial" font-size="10.00">• Mean F1 across seeds</text>
<text text-anchor="middle" x="876" y="-38.25" font-family="Arial" font-size="10.00">• 95% Confidence Interval</text>
</g>
<!-- multi_seed&#45;&gt;stats_report -->
<g id="edge30" class="edge">
<title>multi_seed&#45;&gt;stats_report</title>
<path fill="none" stroke="white" d="M814.93,-466.97C836.25,-448.75 862,-420.02 862,-387.47 862,-387.47 862,-387.47 862,-180.49 862,-146.76 866.88,-108.33 870.88,-82.5"/>
<polygon fill="white" stroke="white" points="874.34,-83.02 872.47,-72.59 867.43,-81.91 874.34,-83.02"/>
<text text-anchor="middle" x="898" y="-283.27" font-family="Arial" font-size="9.00" fill="#dda0dd">aggregate results</text>
</g>
<!-- validation -->
<g id="node23" class="node">
<title>validation</title>
<ellipse fill="#7ed321" stroke="#7ed321" cx="739" cy="-285.47" rx="77.56" ry="28.98"/>
<text text-anchor="middle" x="739" y="-293.97" font-family="Arial" font-size="10.00">Validation Loop</text>
<text text-anchor="middle" x="739" y="-282.97" font-family="Arial" font-size="10.00">• Best model saving</text>
<text text-anchor="middle" x="739" y="-271.97" font-family="Arial" font-size="10.00">• F1&#45;score monitoring</text>
</g>
<!-- train_loop&#45;&gt;validation -->
<g id="edge26" class="edge">
<title>train_loop&#45;&gt;validation</title>
<path fill="none" stroke="white" d="M708.01,-360.26C702.36,-355.11 697.38,-349.18 694,-342.47 690.01,-334.54 691.71,-326.69 696.26,-319.5"/>
<polygon fill="white" stroke="white" points="699.23,-321.38 702.72,-311.38 693.75,-317.02 699.23,-321.38"/>
<text text-anchor="middle" x="728" y="-335.27" font-family="Arial" font-size="9.00" fill="#87ceeb">epoch validation</text>
</g>
<!-- validation&#45;&gt;train_loop -->
<g id="edge31" class="edge">
<title>validation&#45;&gt;train_loop</title>
<path fill="none" stroke="#ffff00" stroke-dasharray="5,2" d="M755.28,-313.9C758.06,-319.83 760.52,-326.21 762,-332.47 763.36,-338.25 763.44,-344.41 762.78,-350.42"/>
<polygon fill="#ffff00" stroke="#ffff00" points="759.33,-349.84 761.07,-360.29 766.23,-351.04 759.33,-349.84"/>
<text text-anchor="middle" x="792" y="-335.27" font-family="Arial" font-size="9.00" fill="#ffff00">early stopping</text>
</g>
<!-- test_eval -->
<g id="node24" class="node">
<title>test_eval</title>
<ellipse fill="#7ed321" stroke="#7ed321" cx="739" cy="-181.49" rx="77.56" ry="28.98"/>
<text text-anchor="middle" x="739" y="-189.99" font-family="Arial" font-size="10.00">Test Evaluation</text>
<text text-anchor="middle" x="739" y="-178.99" font-family="Arial" font-size="10.00">• Confusion matrix</text>
<text text-anchor="middle" x="739" y="-167.99" font-family="Arial" font-size="10.00">• Classification report</text>
</g>
<!-- validation&#45;&gt;test_eval -->
<g id="edge27" class="edge">
<title>validation&#45;&gt;test_eval</title>
<path fill="none" stroke="white" d="M739,-256.34C739,-245.3 739,-232.47 739,-220.62"/>
<polygon fill="white" stroke="white" points="742.5,-220.54 739,-210.54 735.5,-220.54 742.5,-220.54"/>
<text text-anchor="middle" x="762" y="-231.28" font-family="Arial" font-size="9.00" fill="#87ceeb">best model</text>
</g>
<!-- confusion_matrix -->
<g id="node25" class="node">
<title>confusion_matrix</title>
<polygon fill="#9013fe" stroke="#9013fe" points="667.5,-72.25 664.5,-76.25 643.5,-76.25 640.5,-72.25 536.5,-72.25 536.5,-31.25 667.5,-31.25 667.5,-72.25"/>
<text text-anchor="middle" x="602" y="-60.25" font-family="Arial" font-size="10.00">Styled Confusion Matrix</text>
<text text-anchor="middle" x="602" y="-49.25" font-family="Arial" font-size="10.00">• Normalized &amp; Absolute</text>
<text text-anchor="middle" x="602" y="-38.25" font-family="Arial" font-size="10.00">• Dark theme visualization</text>
</g>
<!-- test_eval&#45;&gt;confusion_matrix -->
<g id="edge28" class="edge">
<title>test_eval&#45;&gt;confusion_matrix</title>
<path fill="none" stroke="white" d="M699.51,-156.46C689.79,-149.84 679.69,-142.31 671,-134.5 653,-118.32 635.45,-97.44 622.56,-80.83"/>
<polygon fill="white" stroke="white" points="625.11,-78.4 616.26,-72.58 619.54,-82.65 625.11,-78.4"/>
<text text-anchor="middle" x="703" y="-127.3" font-family="Arial" font-size="9.00" fill="#dda0dd">generate matrix</text>
</g>
<!-- performance_metrics -->
<g id="node27" class="node">
<title>performance_metrics</title>
<path fill="#9013fe" stroke="#9013fe" d="M792.5,-80.8C792.5,-84.36 768.52,-87.25 739,-87.25 709.48,-87.25 685.5,-84.36 685.5,-80.8 685.5,-80.8 685.5,-22.7 685.5,-22.7 685.5,-19.14 709.48,-16.25 739,-16.25 768.52,-16.25 792.5,-19.14 792.5,-22.7 792.5,-22.7 792.5,-80.8 792.5,-80.8"/>
<path fill="none" stroke="#9013fe" d="M792.5,-80.8C792.5,-77.24 768.52,-74.34 739,-74.34 709.48,-74.34 685.5,-77.24 685.5,-80.8"/>
<text text-anchor="middle" x="739" y="-65.75" font-family="Arial" font-size="10.00">Performance Metrics</text>
<text text-anchor="middle" x="739" y="-54.75" font-family="Arial" font-size="10.00">• Weighted F1</text>
<text text-anchor="middle" x="739" y="-43.75" font-family="Arial" font-size="10.00">• Macro F1</text>
<text text-anchor="middle" x="739" y="-32.75" font-family="Arial" font-size="10.00">• Per&#45;class metrics</text>
</g>
<!-- test_eval&#45;&gt;performance_metrics -->
<g id="edge29" class="edge">
<title>test_eval&#45;&gt;performance_metrics</title>
<path fill="none" stroke="white" d="M739,-152.46C739,-136.42 739,-115.93 739,-97.7"/>
<polygon fill="white" stroke="white" points="742.5,-97.56 739,-87.56 735.5,-97.56 742.5,-97.56"/>
<text text-anchor="middle" x="772.5" y="-127.3" font-family="Arial" font-size="9.00" fill="#dda0dd">compute metrics</text>
</g>
</g>
</svg>
